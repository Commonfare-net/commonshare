<!DOCTYPE html>
<meta charset="utf-8">
<head>
<link rel="stylesheet" type="text/css" href="../css/buttons.css" />
<link href="../css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="../css/commonfare.css"></head>

<body>
<!--Container for the network viz-->
  <svg id="bigvis" width="750" height="500"></svg>
    <div id="loadingDiv">
      <img src="icons/ajax-loader.gif" height="160" width="160"/>
    </div>
  <div id="filterelements">
    <div class="sectiontitle">
        Minimum link strength: <b id="strength"></b>
    </div>
     <!--Date slider-->
    <svg id="strengthslider" class="strengthslider" height="55"></svg>
    <div style="width:45%;display:block;float:left;margin-top:20px;" >
      <input type="checkbox" class="mybox" onchange="togglegroups(this)"/>
      Group by clusters
    </div>
    <div style="width:45%;display:inline-block;margin-top:20px;">
      <input type="checkbox" class="mybox2" onchange="toggletags(this)"/>
      Hide tags
    </div>
    <div class="sectiontitle">
      Dynamic clusters <a id="cleardyn" href="#">(Clear)</a>
    </div>
    <div class="sectiontitle">
      Tag filters <a id="cleartags" href="#">(Clear)</a>
    </div>
    <div class="list-group" id="comm-group"></div>
    <div class="list-group" id="list-group"></div>
    <div class="lineygraph" style="width:100%;">
      <svg id="lgraph" width="650" height="300"></svg>
    </div>
  </div>
  <div style="width:60%; position: absolute;top: 530px;">
    <div style="width:90%;" id="datetitle" class="sectiontitle">
      <input type="radio" onchange="toggledate('all')"/> Show all-time&nbsp
      <input type="radio" onchange="toggledate('weekly')"/> Show weekly&nbsp
      <input type="radio" onchange="toggledate('biweekly')"/> Show biweekly&nbsp
      <input type="radio" onchange="toggledate('monthly')"/> Show monthly<br/>
      <b style="font-size:18px;text-align:center;" id="curdate"></b>
    </div>
    <!--Date slider-->
    <svg id="myslider" class="myslider" height="45"></svg>
    <div style="margin:20px;width:90%;" class="sectiontitle">
      <p><pre>
        <img src="icons/comm.PNG" height="14" width="14"/>
        <u><a href="#" onclick="newplot('commoners')">Commoners:</a></u>
        <b id="commoners"></b>
        <img src="icons/comms.PNG" height="14" width="14"/>
        <u><a href="#" onclick="newplot('stories')">Stories:</a></u>
        <b id="stories"></b>
        <img src="icons/alisting.PNG" height="14" width="14"/> 
        <u><a href="#" onclick="newplot('listings')">Listings:</a></u>
        <b id="listings"></b>
        <img src="icons/commt.PNG" height="14" width="14"/>
        <u><a href="#" onclick="newplot('tags')">Tags:</a></u>
        <b id="tags"></b>
      </pre></p>
      <p><pre>
        <img src="icons/asoc.PNG" height="10" width="32"/>
        <u><a href="#" onclick="nwfilter('social');newplot('convo')">Conversations:</a></u>
        <b id="convos"></b>
        <img src="icons/atran.PNG" height="10" width="32"/>
        <u><a href="#" onclick="nwfilter('transaction');newplot('trans')">Transactions:</a></u>
        <b id="transactions"></b>
        <img src="icons/acreate.PNG" height="10" width="32"/>
        <u><a href="#" onclick="nwfilter('story');newplot('create')">Stories written:</a></u>
        <b id="written"></b>
        <img src="icons/acomm.PNG" height="10" width="32"/>
        <u><a href="#" onclick="nwfilter('story');newplot('comment')">Story comments:</a></u>
        <b id="comments"></b>
        <u><a href="#" onclick="nwfilter('all');newplot('')">All</a></u>
      </pre></p>
    </div>
  </div>
</body>

<script src="https://d3js.org/d3.v4.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="../js/areagraph.js"></script>
<script src="../js/admincontrols.js"></script>
<script src="../js/widgets.js"></script>
<script>
// define the line

var data = {};
var datalist = []; //Adding this for the line graph
var drawn = {};
var xScale = d3.scaleLinear()
    .domain([0, 500]).range([0, 500]);
var yScale = d3.scaleLinear()
    .domain([0, 600]).range([0, 600]);

var dateslider;
var dateslidex;
var slideradded = false;
var q = d3.queue();
var datafilecounter = 0;
var taglistindex;
var indexstart = 0;
var strengthslider = 0;
var tag;
var filtertype;
var filternodetype;
var c_nodes = [];
var global_communities = {};
var ids_to_titles = {};
var parseTime = d3.timeParse("%Y/%m/%d");
var formatWeek = d3.timeFormat("%d/%m/%y");
var currentMonthGap = 1;
var svg = d3.select("#bigvis"),
width = +svg.attr("width"),
height = +svg.attr("height");

var g = svg.append("g")
        .attr("transform", "translate(250,250) scale (.35,.35)");

extrashit = g.append("g").attr("z-index",-3);
link = g.append("g")
        .attr("stroke", "#000")
        .attr("stroke-width", 1.5)
        .selectAll(".link"),
node = g.append("g")
        .attr("stroke", "#fff")
        .attr("stroke-width", 1.5)
        .selectAll(".node");
convexHull = g.append("path").attr("class", "hull");


//Tooltip functions from
//http://www.d3noob.org/2013/01/adding-tooltips-to-d3js-graph.html
var div = d3.select("body").append("div")
    .attr("class", "tooltip")
    .style("opacity", 0);


Array.prototype.unique = function () {
    var a = this.concat();
    for (var i = 0; i < a.length; ++i) {
        for (var j = i + 1; j < a.length; ++j) {
            if (a[i] === a[j])
                a.splice(j--, 1);
        }
    }
    return a;
};
var plotpath;




</script>
<script src="../js/adminviz.js"></script>
